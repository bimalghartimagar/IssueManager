@page "/"
@using Domain.Model
@using ThirdParty.Api.Interface;
@inject ITicketService TicketFetchService

<IssueManager.Client.Blazor.WASM.Pages.widgets.WidgetList Data="@widgetData" />

<IssueManager.Client.Blazor.WASM.Pages.tickets.TicketListWrapper tickets="@tickets" />

@code {
    public Dictionary<string, int> widgetData = new Dictionary<string, int>(){
{ "open", 0},
{ "assigned", 0},
{ "closed", 0}
};

    List<Ticket> tickets = new List<Ticket>();

    protected override async Task OnInitializedAsync()
    {
        tickets = await TicketFetchService.GetTickets();
        tickets.ForEach(x =>
        {
            if (x.Status == "open")
            {
                widgetData["open"]++;
            }
            else if (x.Status == "assigned")
            {
                widgetData["assigned"]++;
            }
            else if (x.Status == "closed")
            {
                widgetData["closed"]++;
            }
        });
    }
}